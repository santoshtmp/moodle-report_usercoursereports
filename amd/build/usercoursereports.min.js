/**
 * AMD module for User Course Reports filter
 *
 * @copyright  2025 https://santoshmagar.com.np/
 * @author     santoshtmp7
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("report_usercoursereports/usercoursereports",["jquery","core/ajax","core/str"],(function($,Ajax,str){const filterAreaId="report-usercoursereports-filter-area";function getFilterReportTable(formquerystring){$("#"+filterAreaId).attr("aria-busy","true"),$("#applyfilter").prop("disabled",!0),$("#filter-loading-wrapper").show();const request={methodname:"report_usercoursereports_get_report_table",args:{querystring:formquerystring}},ajaxrequest=Ajax.call([request])[0];ajaxrequest.done((function(response){if(response.status&&response.reporttable&&(window.history.replaceState("","url",response.pageurl),$("#"+filterAreaId).replaceWith(response.reporttable)),$("#usercoursereports-filter [id^=id_error_]").html("").hide(),!response.is_validated){(response.validation_errors||[]).forEach((element=>{let errorContainer=$("#id_error_"+element.field);errorContainer.length&&errorContainer.html(element.error).show()}))}$("#error-response-message").remove(),!response.status&&response.message&&$("#"+filterAreaId).prepend('<p id="error-response-message" class="invalid-feedback" style="display:block;">'+response.message+"</p>")})),ajaxrequest.fail((function(response){window.console.log(response),$("#error-response-message").remove(),$("#"+filterAreaId).prepend('<p id="error-response-message" class="invalid-feedback" style="display:block;">'+response.message+"</p>")})),ajaxrequest.always((function(){$("#"+filterAreaId).removeAttr("aria-busy"),$("#applyfilter").prop("disabled",!1),$("#filter-loading-wrapper").hide()}))}return{init:function(){$(".usercoursereports-filter-field div.col-md-3, .usercoursereports-filter-field div.col-md-9").each((function(){$(this).removeClass("col-md-3 col-md-9")})),document.getElementById("id_perpage")&&document.getElementById("id_perpage").setAttribute("type","number"),function(){const readmorePromise=str.get_string("readmore","report_usercoursereports"),showlessPromise=str.get_string("showless","report_usercoursereports");Promise.all([readmorePromise,showlessPromise]).then((_ref=>{let[readmoreText,showlessText]=_ref;document.querySelectorAll(".singlecoursedetails").forEach((card=>{const summary=card.querySelector(".course-summary"),btn=card.querySelector(".readmore-btn");summary&&btn&&(summary.scrollHeight>summary.clientHeight&&btn.classList.remove("d-none"),btn.addEventListener("click",(()=>{summary.classList.toggle("collapsed-summary"),btn.textContent=summary.classList.contains("collapsed-summary")?readmoreText:showlessText})))}))}))}(),$("#usercoursereports-filter").on("submit",(function(e){if("cancel"!==$(this).find("input[type=submit]:focus").attr("name")){e.preventDefault();getFilterReportTable($(this).serialize())}})),$(document).on("click","#"+filterAreaId+" nav.pagination a.page-link",(function(e){e.preventDefault();const formquerystring=$(this).attr("href").split("?")[1];formquerystring&&getFilterReportTable(formquerystring)})),$(document).on("click","#"+filterAreaId+' thead th.header a[data-sortable="1"]',(function(e){e.preventDefault();const formquerystring=$(this).attr("href").split("?")[1];formquerystring&&getFilterReportTable(formquerystring)})),$(document).on("click","#"+filterAreaId+" .resettable a",(function(e){e.preventDefault();const formquerystring=$(this).attr("href").split("?")[1];formquerystring&&getFilterReportTable(formquerystring)})),$("#usercoursereports-single-search select#id_id").on("change",(function(){if($(this).val()){var form=$(this).closest("form");form.attr("data-form-dirty",!1),form.submit()}}))}}}));

//# sourceMappingURL=usercoursereports.min.js.map