{"version":3,"file":"usercoursereports.min.js","sources":["../src/usercoursereports.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * AMD module for User Course Reports filter + AJAX call\n *\n * @copyright  2025 https://santoshmagar.com.np/\n * @author     santoshtmp7\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/ajax', 'core/notification'], function ($, Ajax, Notification) {\n    return {\n        init: function () {\n\n            // Remove .col-md-3 and .col-md-9 from divs inside .usercoursereports-filter-field\n            $('.usercoursereports-filter-field div.col-md-3, .usercoursereports-filter-field div.col-md-9').each(function () {\n                $(this).removeClass('col-md-3 col-md-9');\n            });\n\n\n            // On form submit\n            $('#usercoursereports-filter').on('submit', function (e) {\n                e.preventDefault();\n\n                // Collect form data into an object\n                const formData = $(this).serializeArray();\n                const dataObj = {};\n                formData.forEach(field => {\n                    if (dataObj[field.name]) {\n                        if (!Array.isArray(dataObj[field.name])) {\n                            dataObj[field.name] = [dataObj[field.name]];\n                        }\n                        dataObj[field.name].push(field.value);\n                    } else {\n                        dataObj[field.name] = field.value;\n                    }\n                });\n\n                window.console.log('Sending params to WS:', dataObj);\n\n                // Call Moodle WebService via core/ajax\n                const request = {\n                    methodname: 'report_usercoursereports_get_report_table',\n                    args: dataObj\n                };\n                const ajaxrequest = Ajax.call([request])[0];\n\n                ajaxrequest.done(function (response) {\n                    if (response && response.reporttable) {\n                        $('#report-container').html(response.reporttable);\n                    } else {\n                        $('#report-container').html('<div class=\"alert alert-warning\">No data found</div>');\n                    }\n                });\n                ajaxrequest.fail(Notification.exception);\n                ajaxrequest.always(function () {\n                });\n\n            });\n\n        }\n    };\n});\n"],"names":["define","$","Ajax","Notification","init","each","this","removeClass","on","e","preventDefault","formData","serializeArray","dataObj","forEach","field","name","Array","isArray","push","value","window","console","log","request","methodname","args","ajaxrequest","call","done","response","reporttable","html","fail","exception","always"],"mappings":";;;;;;;AAuBAA,oDAAO,CAAC,SAAU,YAAa,sBAAsB,SAAUC,EAAGC,KAAMC,oBAC7D,CACHC,KAAM,WAGFH,EAAE,8FAA8FI,MAAK,WACjGJ,EAAEK,MAAMC,YAAY,wBAKxBN,EAAE,6BAA6BO,GAAG,UAAU,SAAUC,GAClDA,EAAEC,uBAGIC,SAAWV,EAAEK,MAAMM,iBACnBC,QAAU,GAChBF,SAASG,SAAQC,QACTF,QAAQE,MAAMC,OACTC,MAAMC,QAAQL,QAAQE,MAAMC,SAC7BH,QAAQE,MAAMC,MAAQ,CAACH,QAAQE,MAAMC,QAEzCH,QAAQE,MAAMC,MAAMG,KAAKJ,MAAMK,QAE/BP,QAAQE,MAAMC,MAAQD,MAAMK,SAIpCC,OAAOC,QAAQC,IAAI,wBAAyBV,eAGtCW,QAAU,CACZC,WAAY,4CACZC,KAAMb,SAEJc,YAAczB,KAAK0B,KAAK,CAACJ,UAAU,GAEzCG,YAAYE,MAAK,SAAUC,UACnBA,UAAYA,SAASC,YACrB9B,EAAE,qBAAqB+B,KAAKF,SAASC,aAErC9B,EAAE,qBAAqB+B,KAAK,2DAGpCL,YAAYM,KAAK9B,aAAa+B,WAC9BP,YAAYQ,QAAO"}